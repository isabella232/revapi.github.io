
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 2020-06-14
 Rendered using Msb3 Maven Skin 0.1.1 (http://tunguski.github.io/msb3-maven-skin)
-->
<html  xml:lang="en" lang="en">

	<head>
		<meta charset="UTF-8" />
		<title>Revapi - Configuration</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="" />
		<meta http-equiv="content-language" content="en" />

		<link href="http://bootswatch.com/3/cosmo/bootstrap.min.css" rel="stylesheet" />
		<link href="./css/bootswatch.css" rel="stylesheet" />
		<link href="./css/msb3-skin.css" rel="stylesheet" />

		<link href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.0.0/styles/default.min.css" rel="stylesheet" />

		<link href="./css/lightbox.css" rel="stylesheet" />

		<link href="./css/site.css" rel="stylesheet" />

		<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->


		
	</head>

	<body class="page-configuration project-revapi-site" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

		<header class="navbar navbar-default navbar-fixed-top">
			<div class="container">
				<div class="navbar-header">
					<a class="navbar-toggle collapsed" data-toggle="collapse" data-target="#top-nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<a class="navbar-brand" href="./">Revapi</a>
				</div>
					<div class="collapse navbar-collapse" id="top-nav-collapse">
						<ul class="nav navbar-nav navbar-right">
							<li ><a href="https://diff.revapi.org" title="Online Check" class="externalLink">Online Check</a></li>
							<li ><a href="news.html" title="News">News</a></li>
							<li ><a href="getting-started.html" title="Getting Started">Getting Started</a></li>
							<li ><a href="faq.html" title="FAQ">FAQ</a></li>
							<li ><a href="downloads.html" title="Downloads">Downloads</a></li>
							<li class="dropdown active">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Basic Info <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="architecture.html" title="Architecture">Architecture</a></li>
									<li class="active"><a href="" title="Configuration">Configuration</a></li>
									<li ><a href="building.html" title="Building">Building</a></li>
									<li ><a href="extensions.html" title="Extensions">Extensions</a></li>
								</ul>
							</li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Sub Projects <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="modules/revapi-maven-plugin/index.html" title="Maven Plugin">Maven Plugin</a></li>
									<li ><a href="https://github.com/palantir/gradle-revapi" title="Gradle Plugin (external)" class="externalLink">Gradle Plugin (external)</a></li>
									<li ><a href="modules/revapi-ant-task/index.html" title="Ant Task">Ant Task</a></li>
									<li ><a href="modules/revapi/index.html" title="Revapi API">Revapi API</a></li>
									<li ><a href="modules/revapi-basic-features/index.html" title="Basic Features">Basic Features</a></li>
									<li ><a href="modules/revapi-java/index.html" title="Java Extension">Java Extension</a></li>
									<li ><a href="modules/revapi-java-spi/index.html" title="Java Extension SPI">Java Extension SPI</a></li>
									<li ><a href="modules/revapi-reporter-file-base/index.html" title="File-based Reporters">File-based Reporters</a></li>
									<li ><a href="modules/revapi-reporter-text/index.html" title="Text Report Extension">Text Report Extension</a></li>
									<li ><a href="modules/revapi-reporter-json/index.html" title="JSON Report Extension">JSON Report Extension</a></li>
								</ul>
							</li>
						</ul>
					</div><!--/.nav-collapse -->
			</div>
		</header>

	<div class="container">

	<!-- Masthead
	================================================== -->

	<header>
	<div class="jumbotron">
		<div class="row">
			<div class="col-md-12">
				<div class="pull-left">
					<a href="https://revapi.org" id="bannerLeft"><h1>Revapi</h1></a>
					<p class="lead">Full-featured API checker for Java and beyond.</p>
				</div>
				<div class="pull-right">
				</div>
			</div>
		</div>
	</div>
	</header>

	<div class="main-body">
	<div class="row">
		<div class="col-md-8">
			<div class="body-content">
<div class="sect1"> 
 <div class="page-header">
  <h2 id="configuration">Configuration</h2>
 </div> 
 <div class="sectionbody"> 
  <div class="paragraph"> 
   <p>Each of the extensions (see <a href="architecture.html">architecture</a>) can be supplied with configuration. Revapi natively uses <a href="https://github.com/jbossas/jboss-dmr">JBoss DMR</a> to represent the configuration in the code and supports JSON to read the configuration from files. Revapi can be made to also understand XML (as is done in the Revapi Maven plugin and standalone CLI).</p> 
  </div> 
  <div class="paragraph"> 
   <p>Each extension is uniquely identified using its extension ID, which is supposed to be a dot-separated hierarchical name, e.g. <code>revapi.java</code>, <code>revapi.osgi</code>, etc. This ID is used to locate the configuration for the given extension.</p> 
  </div> 
  <div class="paragraph"> 
   <p>Revapi has been around for a little bit and over the time it has evolved. Originally (up until Revapi API 0.8.0), each extension was instantiated exactly once and therefore also configured exactly once. Since Revapi API 0.8.0, supported by Revapi Maven plugin 0.9.0 and Revapi CLI 0.6.1 and onwards, there can be multiple configurations for each extension (and the extension can be therefore instantiated multiple times). This brings the ability to e.g. have 2 differently configured text reporter instances, each generating a different kind of output. Unfortunately, this complicates the configuration, because it is no longer possible to have a single "configuration tree" where extensions would read their configurations from their declared locations.</p> 
  </div> 
  <div class="paragraph"> 
   <p>Therefore, since Revapi API 0.8.0 there is a new kind of JSON format for configuration (which in turn also enables the maven plugin and CLI to support XML configuration btw). To ease the migration to the new versions, the old configuration format is still supported (but mixing the two formats can lead to unresolvable situations, see the <a href="#multi_file_configuration">Multi-file Configuration</a> section for more details).</p> 
  </div> 
  <div class="sect2"> 
   <h3 id="xml_configuration_format">XML Configuration Format</h3> 
   <div class="paragraph"> 
    <p>An XML document containing Revapi configuration is assumed to contain a number of child elements of the root element, each of which is supposed to be a configuration of a single extension instance. The root element can have any name as it is basically ignored and used only as a starting point for reading the actual configuration of the extensions.</p> 
   </div> 
   <div class="paragraph"> 
    <p>For example:</p> 
   </div> 
   <div class="listingblock"> 
    <div class="content"> 
     <pre class="highlight"><code class="language-xml" data-lang="xml">&lt;revapiExtensionsOrWhatever&gt;
  &lt;revapi.java&gt;
    ...
  &lt;/revapi.java&gt;
  &lt;revapi.ignore&gt;
    ...
  &lt;/revapi.ignore&gt;
  &lt;my.extension&gt;
    ...
  &lt;/my.extension&gt;
&lt;/revapiExtensionsOrWhatever&gt;</code></pre> 
    </div> 
   </div> 
   <div class="paragraph"> 
    <p>Each of the children, representing the extension instance, has a name that corresponds to the extension ID of the extension being configured.</p> 
   </div> 
   <div class="paragraph"> 
    <p>If you want to configure a single extension multiple times, you can do so very simply like this:</p> 
   </div> 
   <div class="listingblock"> 
    <div class="content"> 
     <pre class="highlight"><code class="language-xml" data-lang="xml">&lt;revapiExtensionsOrWhatever&gt;
  &lt;revapi.reporter.text&gt;
    ...
  &lt;/revapi.reporter.text&gt;
  &lt;revapi.reporter.text&gt;
    ...
  &lt;/revapi.reporter.text&gt;
  ...
&lt;/revapiExtensionsOrWhatever&gt;</code></pre> 
    </div> 
   </div> 
   <div class="paragraph"> 
    <p>Simply having multiple child elements with the same name is enough. If you want to read the revapi configuration from multiple files, you might want to declare an additional "extension instance ID" (as opposed to just the extension ID) which you can use to mark certain configurations as targeting the same "thing" when merging the configuration from the multiple files. Please consult <a href="#multi_file_configuration">Multi-file Configuration</a> for more details.</p> 
   </div> 
  </div> 
  <div class="sect2"> 
   <h3 id="json_configuration_format">JSON Configuration Format</h3> 
   <div class="paragraph"> 
    <p>As explained above, each extension can be configured multiple times. To support this in JSON, the JSON configuration looks like this:</p> 
   </div> 
   <div class="listingblock"> 
    <div class="content"> 
     <pre class="highlight"><code class="language-javascript" data-lang="javascript">[
  {
    "extension": "revapi.reporter.text",
    "id": "optional-id",
    "configuration": {
      ... the actual configuration of the extension according to its schema ...
    }
  },
  {
    "extension": "revapi.reporter.text",
    "configuration": {
      ...
    }
  },
  {
    "extension": "revapi.ignore",
    "configuration": {
      ...
    }
  },
  ...
]</code></pre> 
    </div> 
   </div> 
   <div class="paragraph"> 
    <p>The configuration is a list. The members of the list are individual configuration objects for the extensions. The extension being configured is specified by the <code>extension</code> key and the configuration (conforming to the schema specified by the extension) is present under the <code>configuration</code> key.</p> 
   </div> 
   <div class="paragraph"> 
    <p>The optional <code>id</code> key is useful if there are multiple configuration sources (see <a href="#multi_file_configuration">multi file configuration</a> for example) as it affects how the configurations from the different sources are merged together.</p> 
   </div> 
   <div class="sect3"> 
    <h4 id="the_legacy_json_configuration_format">The Legacy JSON Configuration Format</h4> 
    <div class="admonitionblock warning"> 
     <table> 
      <tbody> 
       <tr> 
        <td class="icon"> 
         <div class="title">
           Warning 
         </div> </td> 
        <td class="content"> This describes the obsolete JSON configuration format that cannot handle multiple configurations per extension. If you still use it, rest assured that it is still supported (with the exception of certain scenarios during merging of multiple configuration sources) but you are encouraged to start using the new configuration format. </td> 
       </tr> 
      </tbody> 
     </table> 
    </div> 
    <div class="paragraph"> 
     <p>The JSON data contains the configuration of all the extensions. Each of the extensions declares a "root" in the JSON data from which it reads its configuration (for example, ignoring specific problems found during the analysis can be done using the <code>IgnoreDifferenceTransform</code> extension from the <a href="modules/revapi-basic-features/index.html">basic features</a> under the root <code>revapi.ignore</code>).</p> 
    </div> 
    <div class="paragraph"> 
     <p>So, without further ado, let’s configure the java extension to report the classes it finds missing from the API rather than failing the analysis upon encountering them and also only include the archives with <code>com.acme</code> groupId in the analysis:</p> 
    </div> 
    <div class="listingblock"> 
     <div class="content"> 
      <pre class="highlight"><code class="language-javascript" data-lang="javascript">{
  "revapi": {
    "java": {
      "missing-classes": {
        "behavior": "report"
      }
    },
    "filter": {
      "archives": {
        "include": ["com\\.acme:.*"]
      }
    }
  }
}</code></pre> 
     </div> 
    </div> 
    <div class="paragraph"> 
     <p>The configuration options of the various extensions can be found in their respective docs: <a href="../revapi-basic-features/index.html">basic features documentation</a>, <a href="modules/revapi-java/index.html">java extension documentation</a>.</p> 
    </div> 
   </div> 
  </div> 
  <div class="sect2"> 
   <h3 id="multi_file_configuration">Multi-file Configuration</h3> 
   <div class="paragraph"> 
    <p>Sometimes it can be handy to split the configuration of Revapi analysis in separate files - this can be done for various reasons - you might want to keep the config of different extensions separate or you want to compose the config from various contributing locations, etc. This is supported by both the Maven plugin and the CLI. Please consult their respective documentations for the details.</p> 
   </div> 
   <div class="paragraph"> 
    <p>When the analysis configuration is split amongst several files, it needs to be merged together before it is applied to Revapi. This process is slightly complex with the ability for a single extension to be configured multiple times but in the end is somewhat similar to the way Maven merges the executions of a plugin - as long as the executions are defined once in the effective POM, they don’t need to be assigned IDs. If there are multiple executions and you override them in child POMs, they need to have the IDs assigned so that it is clear what executions in child POM need to be merged with what executions in the parent POM.</p> 
   </div> 
   <div class="paragraph"> 
    <p>In Revapi, too, an extension configuration can optionally have an ID. In JSON this is expressed like this:</p> 
   </div> 
   <div class="listingblock"> 
    <div class="content"> 
     <pre class="highlight"><code class="language-javascript" data-lang="javascript">...
    {
      "extension": "my.extension",
      "id": "id",
      "configuration": ...
    }
...</code></pre> 
    </div> 
   </div> 
   <div class="paragraph"> 
    <p>and in XML like so:</p> 
   </div> 
   <div class="listingblock"> 
    <div class="content"> 
     <pre class="highlight"><code class="language-xml" data-lang="xml">...
    &lt;my.extension id="myid"&gt;
      ...
    &lt;/my.extension&gt;
...</code></pre> 
    </div> 
   </div> 
   <div class="paragraph"> 
    <p>When merging configurations without an explicit ID, everything works as long as there is at most a single configuration for each extension in each configuration file to be merged. As soon as there is more than one configuration for some extension in one of the configuration files, you need to assign IDs to the configurations of that extension so that it is clear what configs should be merged with what.</p> 
   </div> 
  </div> 
  <div class="sect2"> 
   <h3 id="pipeline">Pipeline</h3> 
   <div class="paragraph"> 
    <p>As described in the <a href="architecture.html">architecture</a>, the analysis forms a simple pipeline comprised of the different extensions. The behavior and composition of the pipeline itself can also be configured (in addition to configuring the extensions themselves as described above).</p> 
   </div> 
   <div class="paragraph"> 
    <p>The pipeline configuration is completely separate from the analysis configuration. The Maven plugin uses <code>pipelineConfiguration</code> element for specifying it (as opposed to the <code>analysisConfiguration</code> for the configuration of the analysis performed by the extensions) and the CLI supports this by the explicit list of extensions to use and the <code>transform-blocks</code> commandline argument.</p> 
   </div> 
   <div class="sect3"> 
    <h4 id="allowed_extensions">Allowed Extensions</h4> 
    <div class="paragraph"> 
     <p>Each of the extension types - analyzers, filters, transforms and reporters can be configured to only include or exclude extensions with certain extension IDs.</p> 
    </div> 
    <div class="paragraph"> 
     <p>E.g. in Maven plugin :</p> 
    </div> 
    <div class="listingblock"> 
     <div class="content"> 
      <pre class="highlight"><code class="language-xml" data-lang="xml">&lt;build&gt;
  &lt;plugins&gt;
    &lt;plugin&gt;
      &lt;groupId&gt;org.revapi&lt;/groupId&gt;
      &lt;artifactId&gt;revapi-maven-plugin&lt;/artifactId&gt;
      &lt;version&gt;...&lt;/version&gt;
      &lt;configuration&gt;
        &lt;pipelineConfiguration&gt;
          &lt;analyzers&gt;
            &lt;include&gt;
              &lt;item&gt;my.scala.analyzer&lt;/item&gt;
            &lt;/include&gt;
          &lt;/analyzers&gt;
          &lt;filters&gt;
            &lt;exclude&gt;
              &lt;item&gt;my.funky.filter&lt;/item&gt;
              &lt;item&gt;revapi.java.filter.annotated&lt;/item&gt;
            &lt;/exclude&gt;
          &lt;/filters&gt;
          &lt;transforms&gt;
            ...
          &lt;/transforms&gt;
          &lt;reporters&gt;
            ...
          &lt;/reporters&gt;
        &lt;/pipelineConfiguration&gt;
      &lt;/configuration&gt;
    &lt;/plugin&gt;
  &lt;/plugins&gt;
&lt;/build&gt;</code></pre> 
     </div> 
    </div> 
    <div class="paragraph"> 
     <p>In the above, you can see that each type of the Revapi extensions can separately specify which extensions of that certain type to include and which to exclude (when include is not present, all extensions from the classpath are included. The exclude only excludes from the included extensions). In the example above, only the analyzers and filters have a concrete configuration, but the rest of the extension types follows the same logic. An extension type pipeline configuration can in fact have both <code>include</code> and <code>exclude</code> sections but that doesn’t make much sense, because the <code>exclude</code> would only exclude from the list provided in the <code>include</code>. This might come in handy though in a more complex scenarios in Maven where a child pom inherits configuration from parent pom and would like to modify it (parent pom defines a set of of extensions to use but the child pom wants to constrain it).</p> 
    </div> 
   </div> 
   <div class="sect3"> 
    <h4 id="transform_blocks">Transform Blocks</h4> 
    <div class="paragraph"> 
     <p>New in Revapi API 0.11.0 (supported by Maven plugin 0.11.0 and CLI 0.9.0 onwards) is the ability to group transformations into blocks which can help in situations where one needs to "prepare" the differences using one transform before being passed to the other (the <a href="architecture.html">architecture</a> has more details on this).</p> 
    </div> 
    <div class="paragraph"> 
     <p>The transformation blocks are configured, as the allowed extensions, in the pipeline configuration.</p> 
    </div> 
    <div class="listingblock"> 
     <div class="content"> 
      <pre class="highlight"><code class="language-xml" data-lang="xml">&lt;build&gt;
  &lt;plugins&gt;
    &lt;plugin&gt;
      &lt;groupId&gt;org.revapi&lt;/groupId&gt;
      &lt;artifactId&gt;revapi-maven-plugin&lt;/artifactId&gt;
      &lt;version&gt;...&lt;/version&gt;
      &lt;configuration&gt;
        &lt;pipelineConfiguration&gt;
          &lt;transformBlocks&gt;
            &lt;block&gt;
              &lt;item&gt;...extension ID or extension instance ID of a transform...&lt;/item&gt;
              &lt;item&gt;...extension ID or extension instance ID of a transform...&lt;/item&gt;
              ...
            &lt;block&gt;
            ...
          &lt;/transformBlocks&gt;
          ...
        &lt;/pipelineConfiguration&gt;
      &lt;/configuration&gt;
    &lt;/plugin&gt;
  &lt;/plugins&gt;
&lt;/build&gt;</code></pre> 
     </div> 
    </div> 
    <div class="paragraph"> 
     <p>as explained in the <a href="architecture.html">architecture</a>, the transform blocks enable multiple transform to "act as one".</p> 
    </div> 
   </div> 
  </div> 
 </div> 
</div>
			</div>
		</div>
		<div class="col-md-4">
			<div id="toc-sidebar">
				<div class="well">
					<ul class="nav nav-list">
						<li class="nav-header">Table of Contents</li>
		<li class="dropdown"><a href="#configuration" title="Configuration">Configuration <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#xml_configuration_format" title="XML Configuration Format">XML Configuration Format</a>
		<li class="dropdown"><a href="#json_configuration_format" title="JSON Configuration Format">JSON Configuration Format <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#the_legacy_json_configuration_format" title="The Legacy JSON Configuration Format">The Legacy JSON Configuration Format</a>
			</ul>
		</li>
		<li><a href="#multi_file_configuration" title="Multi-file Configuration">Multi-file Configuration</a>
		<li class="dropdown"><a href="#pipeline" title="Pipeline">Pipeline <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#allowed_extensions" title="Allowed Extensions">Allowed Extensions</a>
		<li><a href="#transform_blocks" title="Transform Blocks">Transform Blocks</a>
			</ul>
		</li>
			</ul>
		</li>
					</ul>
				</div>
			</div>
		</div>
	</div>
	</div>

	</div><!-- /container -->

	<!-- Footer
	================================================== -->
	<footer class="well">
		<div class="container">
			<div class="row">
				<div class="col-md-3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Basic Info</li>
						<li >
							<a href="architecture.html" title="Architecture">Architecture</a>
						</li>
						<li class="active">
							<a href="#" title="Configuration">Configuration</a>
						</li>
						<li >
							<a href="building.html" title="Building">Building</a>
						</li>
						<li >
							<a href="extensions.html" title="Extensions">Extensions</a>
						</li>
						<li class="nav-header">Sub Projects</li>
						<li >
							<a href="modules/revapi-maven-plugin/index.html" title="Maven Plugin">Maven Plugin</a>
						</li>
						<li >
							<a href="https://github.com/palantir/gradle-revapi" title="Gradle Plugin (external)" class="externalLink">Gradle Plugin (external)</a>
						</li>
						<li >
							<a href="modules/revapi-ant-task/index.html" title="Ant Task">Ant Task</a>
						</li>
						<li >
							<a href="modules/revapi/index.html" title="Revapi API">Revapi API</a>
						</li>
						<li >
							<a href="modules/revapi-basic-features/index.html" title="Basic Features">Basic Features</a>
						</li>
						<li >
							<a href="modules/revapi-java/index.html" title="Java Extension">Java Extension</a>
						</li>
						<li >
							<a href="modules/revapi-java-spi/index.html" title="Java Extension SPI">Java Extension SPI</a>
						</li>
						<li >
							<a href="modules/revapi-reporter-file-base/index.html" title="File-based Reporters">File-based Reporters</a>
						</li>
						<li >
							<a href="modules/revapi-reporter-text/index.html" title="Text Report Extension">Text Report Extension</a>
						</li>
						<li >
							<a href="modules/revapi-reporter-json/index.html" title="JSON Report Extension">JSON Report Extension</a>
						</li>
					</ul>
				</div>
				<div class="col-md-3 bottom-nav">
					<ul class="nav nav-list">
					</ul>
				</div>
				<div class="col-md-3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Maven Documentation</li>
						<li >
							<a href="project-info.html" title="Project Information">Project Information <i class="glyphicon glyphicon-chevron-right"></i></a>
						</li>
					</ul>
				</div>
				<div class="col-md-3 bottom-description">
					<blockquote>Revapi</blockquote>
				</div>
			</div>
		</div>
	</footer>

	<div class="container subfooter">
		<div class="row">
			<div class="col-md-12">
				<p class="pull-right"><a href="#">Back to top</a></p>
				<p class="copyright">Copyright &copy;2014-2020 <a href="http://lukas.krejci.pw">Lukas Krejci</a>. All Rights Reserved.</p>
				<p><a href="http://github.com/tunguski/msb3-maven-skin" title="Msb3 Maven skin">Msb3 Maven skin</a> by <a href="http://matsuo.pl" target="_blank" title="Marek Romanowski">Marek Romanowski</a>.</p>
			</div>
		</div>
	</div>

	<!-- Le javascript
	================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

	<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
	<script src="./js/lightbox.min.js"></script>
	<script src="./js/msb3-scroll.js"></script>
	<script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.0.0/highlight.min.js"></script>
	
<script async="true" src="//revapi-org.disqus.com/count.js" id="dsq-count-scr"></script>
<script>(function(f, a, t, h, o, m){
          a[h]=a[h]||function(){
          (a[h].q=a[h].q||[]).push(arguments)
          };
          o=f.createElement('script'),
          m=f.getElementsByTagName('script')[0];
          o.async=1; o.src=t; o.id='fathom-script';
          m.parentNode.insertBefore(o,m)
          })(document, window, '//stats.revapi.org/tracker.js', 'fathom');
          fathom('set', 'siteId', 'MDATT');
          fathom('trackPageview');</script>
	<script src="./js/msb3-skin.js"></script>

	</body>
</html>